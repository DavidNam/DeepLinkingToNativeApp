var NativeAppLauncher=function(a){"use strict";function b(a,b){console.log(a+":"+JSON.stringify(b,null,4))}var c={},d={getAppUri:function(){if(!c.appUri)throw new Error("Settings does not have valid appUri.");return"#"},getAppLauncherEl:function(){if(!c.appLauncherElId)throw new Error("Settings does not have valid appLauncherElId");return a("#"+c.appLauncherElId)},getNotSupportedMessage:function(){if(!c.appLauncherElId)throw new Error("Settings does not have valid NotSupportedMessage");return c.notSupportedMessage},getCampaignValue:function(){return c.campaignCode},getAppStoreURI:function(){return"#"}},e=a.extend({},d,{getAppUri:function(){if(!c.androidAppId)throw new Error("Settings does not have valid androidAppId");return"intent://m/#Intent;scheme="+c.appUri+";package="+c.androidAppId+";end"},getAppStoreURI:function(){var a=this.getCampaignValue()?"&referrer=utm_source%3Dother%26utm_campaign%3D"+this.getCampaignValue():"";return"https://play.google.com/store/apps/details?id="+c.androidAppId+a}}),f=a.extend({},d,{getAppStoreURI:function(){return this.getCampaignValue()?r.appendQueryParameter(c.iOsAppStore,"ct",this.getCampaignValue()):c.iOsAppStore},getUniversalLinkingUrl:function(){if(!c.androidAppId)throw new Error("Settings does not have valid universalLinkURL");return c.universalLinkUrl},getAppUri:function(){if(!c.appUri)throw new Error("Settings does not have valid AppURI");return c.appUri}}),g=function(a){this.strategyParameters=a,this.init=function(){}},h=function(a){this.init=function(){var b=a.getAppLauncherEl(),c=a.getAppUri();b.click(function(a){a.preventDefault(),window.location.reload()}),window.location=c}},i=function(b){g.call(this,b);var c=["pagehide","blur","beforeunload"],d=null,e=function(){clearTimeout(d),d=null,a(window).unbind(c.join(""))},f=b.getAppLauncherEl();this.init=function(){f.attr("href",b.getAppUri()),h(),f.unbind("click").on("click",function(){})};var h=function(){var f=document.createElement("iframe");f.style.border="none",f.style.width="1px",f.style.height="1px",f.onload=function(){document.location=b.getAppUri()},f.src=b.getAppUri(),window.onload=function(){document.body.appendChild(f)},d=setTimeout(function(){window.location=b.getAppStoreURI()},1e3),a(window).bind(c.join(" "),e)}},j=function(b){g.call(this,b),this.init=function(){var c=new i(b),d=b.getAppLauncherEl(),e=d.attr("id");a("body").on("click","#"+e,function(a){a.preventDefault(),c.init()})}},k=function(b){g.call(this,b),this.init=function(){var c=b.getAppLauncherEl().attr("id");a("body").on("click","#"+c,function(a){a.preventDefault(),alert(b.getNotSupportedMessage())})}},l=function(a){function b(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";document.cookie=a+"="+b+d+"; path=/"}function c(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}g.call(this,a),this.init=function(){if(!a.getUniversalLinkingUrl())throw new Error("Universal Linking: Invalid url provided: "+a.getUniversalLinkingUrl());var d,e=a.getAppLauncherEl(),f="ul-"+document.referrer;d=a.getUniversalLinkingUrl();var g=c(f);-1===document.referrer.indexOf(location.protocol+"//"+location.host)&&(g||b(f,1,.00208333),b(f,parseInt(g)+1,.00208333)),g>1&&(d=a.getAppStoreURI(),window.location=a.getAppStoreURI()),e.click(function(){window.location=d})}},m=function(){var a,g=d;return o().isIOS?(a="ios",g=f):o().isAndroid?(a="android",g=e):(a="desktop or default",g=d),c.debug&&g&&b("AppLaunchParameter",a),g},n=function(a){var d,e=m();if("cta"==a||void 0==a)d=new j(e);else if("direct"==a)d=new i(e);else if("ul"==a)d=new l(e);else if("notsupported"==a)d=new k(e);else{if("directapponly"!=a)throw new Error("Deeplinking: Unsupported device type");d=new h(e)}return c.debug&&d&&b("AppLaunchStrategyType",a),d},o=function(){var a=window.navigator.userAgent.toLowerCase(),b=function(){return c()?parseInt(a.match(/os\s+(\d)_/)[1],10):!1},c=function(){return/(?:i(?:phone|p(?:o|a)d))/.test(a)},d=function(){return!!a.match(/FBAV/i)},e=function(){return a.indexOf("chrome")>-1},f=function(){var b=a.match(/chrom(e|ium)\/([0-9]+)\./);return b?parseInt(b[2],10):!1},g=function(){return a.indexOf("twitter")>-1},h=function(){return a.indexOf("android")>-1},i=function(){var b=a.match(/android\s([0-9\.]*)/);return b?parseFloat(b[1]):!1},j=function(){return h()&&e()&&l()&&!d()},k=function(){return!d()&&(h()&&m()&&m()<537||f()&&f()<37)},l=function(){return a.indexOf("version")>-1},m=function(){var b=a.match(/AppleWebKit\/([\d.]+)/);return b?parseFloat(b[1]):!1};return{isIOS:c(),iOSVersion:b(),isAndroid:h(),androidVersion:i(),isAndroidStockBrowser:j(),isAndroidNativeBrowser:k(),isFacebook:d(),isChrome:e(),isTwitter:g()}},p=function(){var a=o(),d=new n("cta");return a.isIOS?a.iOSVersion<9?(d=new n("direct"),a.isTwitter&&(d=new n("directapponly"))):(d=new n("direct"),a.isFacebook&&(d=new n("ul"))):a.isAndroid&&(d=new n("cta"),(a.isAndroidNativeBrowser||a.isAndroidStockBrowser)&&(d=new n("notsupported"))),1==c.debug&&b("browser",a),d},q=function(a){return c=a,p().init()},r={getQueryString:function(a){void 0==a&&(a=window.location.search),a=a.split("+").join(" ");for(var b,c={},d=/[?&]?([^=]+)=([^&]*)/g;b=d.exec(a);)c[decodeURIComponent(b[1])]=decodeURIComponent(b[2]);return c},appendQueryParameter:function(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|$)","i"),e=-1!==a.indexOf("?")?"&":"?";return a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+e+b+"="+c}};return{init:q,browserChecker:o,util:r,androidParameters:e,iOSParameters:f}}(jQuery);